/***************************************************************************
* COPYRIGHT NOTICE
* Copyright 2019 Horizon Robotics, Inc.
* All rights reserved.
***************************************************************************/

#ifndef UTILITY_SENSOR_INC_OV2311_OV9284_SETTING_H_
#define UTILITY_SENSOR_INC_OV2311_OV9284_SETTING_H_


#define MAX_20087_I2C_BUS 0

uint8_t ov2311_ov9284_power_on_setting[] = {
	0x04, 0x50, 0x00, 0x01, 0x1f,	/* enable output */
};

uint8_t ov2311_ov9284_power_off_setting[] = {
	0x04, 0x50, 0x00, 0x01, 0x10,	/* disable output */
};

uint8_t ov2311_ov9284_stream_on_setting[] = {
	0x04, 0x90, 0x03, 0x13, 0x42,	// enable CSI output
};

uint8_t ov2311_ov9284_stream_off_setting[] = {
	0x04, 0x90, 0x03, 0x13, 0x00,	// enable mipi output           
};

uint8_t ov2311_ov9284_init_setting[] = {
	// 9296a <-----link Aï¼ˆGMSL2)<------MAX9295A <---- DVP <-----ISP  (2Mega)
	//     \-<----link B (GMSL2)<------MAX9295A <---- DVP <----- ISP  (2Mega)

	0x04, 0x90, 0x00, 0x10, 0xf1,	/* reset 9296 */
	0x00, 0x5F,	/* delay */

	0x04, 0x90, 0x00, 0x01, 0x01,	/* change to 3Gbps */

	// Disable MAX9296A MIPI output, CSI_OUT_EN=0
	0x04, 0x90, 0x03, 0x13, 0x00,
	0x04, 0x90, 0x00, 0x10, 0x02,	// enable LINK B
	0x04, 0x90, 0x00, 0x10, 0x22,	// Oneshort reset
	0x00, 0x5F,	// delay 50-100ms
	0x00, 0x5F,	// delay 50-100ms

	// --------------LINK B (DMS) MAX9295A ov2311 Settings----------------------
	0x04, 0x80, 0x00, 0x00, 0x84,
	0x00, 0x5F,    // delay 50-100ms
	0x00, 0x5F,
	0x04, 0x84, 0x00, 0x05, 0x00,

	// increase CMU Voltage anti-interference
	0x04, 0x84, 0x03, 0x02, 0x10,

	// MAX9295 Parallel video enabled
	0x04, 0x84, 0x00, 0x07, 0xF7,
	// Set 9295A pipe x stream ID
	0x04, 0x84, 0x00, 0x53, 0x11,	//pipe Y ID =1; 9295A pipeX(1)
	0x04, 0x84, 0x01, 0x00, 0x60,
	0x04, 0x84, 0x01, 0x01, 0x4A,

	/* DVP configuration for ov2311 */
	0x04, 0x84, 0x01, 0xb0, 0x04,
	0x04, 0x84, 0x01, 0xb1, 0x05,
	0x04, 0x84, 0x01, 0xb2, 0x06,
	0x04, 0x84, 0x01, 0xb3, 0x07,
	0x04, 0x84, 0x01, 0xb4, 0x08,
	0x04, 0x84, 0x01, 0xb5, 0x09,
	0x04, 0x84, 0x01, 0xb6, 0x0a,
	0x04, 0x84, 0x01, 0xb7, 0x0b,

	0x00, 0x5F,
	// --------------LINK A (IMS) MAX9295A  ov9284 Settings---------------------- 
	0x04, 0x90, 0x00, 0x10, 0x01,	//enable LINK A
	0x04, 0x90, 0x00, 0x10, 0x21,	//one shot reset
	0x00, 0x5F,	//Delay 100ms

	/* DVP configuration for ov9284 */
	0x04, 0x80, 0x00, 0x6B, 0x16,
	0x04, 0x80, 0x00, 0x73, 0x17,
	0x04, 0x80, 0x00, 0x7B, 0x36,
	0x04, 0x80, 0x00, 0x83, 0x36,
	0x04, 0x80, 0x00, 0x93, 0x36,
	0x04, 0x80, 0x00, 0x9B, 0x36,
	0x04, 0x80, 0x00, 0xA3, 0x36,
	0x04, 0x80, 0x00, 0xAB, 0x36,
	0x04, 0x80, 0x00, 0x8B, 0x36,

	// MAX9295 Parallel video enabled
	0x04, 0x80, 0x00, 0x07, 0xF7,

	0x04, 0x80, 0x03, 0x11, 0xf0,	// csi-b -> xyzu 
	0x04, 0x80, 0x03, 0x08, 0x6f,	// csi-b

	// Set 9295A pipe x stream ID
	0x04, 0x80, 0x00, 0x53, 0x02,	// x -> stream 0 0x00

	0x04, 0x80, 0x01, 0x00, 0x60,
	0x04, 0x80, 0x01, 0x01, 0x4A,
	0x04, 0x80, 0x00, 0x05, 0x00,

    //--------------Enable LINK A/LINK B------------------------
	0x04, 0x90, 0x00, 0x10, 0x23,
	0x00, 0x5F,	//delay 100ms

    // ------------------ MAX9296 Settings ---------------------
	// Software override for BPP, VC and DT	
	0x04, 0x90, 0x03, 0x16, 0x5E,	/* pipe X datatype 0x1e */
	0x04, 0x90, 0x03, 0x17, 0x7E,	/* pipe Y datatype 0x1e */
	0x04, 0x90, 0x03, 0x18, 0x02,	/* pipe Z datatype 0x1e */
	0x04, 0x90, 0x03, 0x19, 0x48,	/* soft bpp Y = 0x8 for mux */
	0x04, 0x90, 0x03, 0x1A, 0x00,
	0x04, 0x90, 0x03, 0x1D, 0xa0,	/* enable pipe Y soft override */
	0x04, 0x90, 0x03, 0x20, 0x6E,	// enable pipe Z soft override, Set MIPI speed 1400Mbps

	0x04, 0x90, 0x03, 0x22, 0x60,	/* enable pipe Y,Z yuv422 8/10bit muxed mode */
	0x04, 0x90, 0x03, 0x30, 0x04,	// set des in 2x4 mode 
	0x04, 0x90, 0x04, 0x4A, 0xD0,	// Four lane output from MIPI Port A
	

	// Send YUV422, FS, and FE from Pipe Y to Controller 1
	0x04, 0x90, 0x04, 0x4B, 0x07,	// Enable 3 Mappings
	0x04, 0x90, 0x04, 0x6D, 0x15,	// Destionation Controller = Controller 1. Controller 1 sends data to MIPI Port A
	// For the following MSB 2 bits = VC, LSB 6 bits =DT
	0x04, 0x90, 0x04, 0x4D, 0x1E,	/* SRC  0b00011110,DT = 0x1E (YUV422-8bit) VC=1 */
	0x04, 0x90, 0x04, 0x4E, 0x5E,	/* DEST 0b01011110,DT = 0x5E,(YUV422-8bit) 0x5E */
	0x04, 0x90, 0x04, 0x4F, 0x00,	/* SRC  DT = Frame Start */
	0x04, 0x90, 0x04, 0x50, 0x40,	/* DEST DT = Frame Start */
	0x04, 0x90, 0x04, 0x51, 0x01,	/* SRC  DT = Frame End */
	0x04, 0x90, 0x04, 0x52, 0x41,	/* DEST DT = Frame End */

	// Send YUV422, FS, and FE from Pipe Z to Controller 1
	0x04, 0x90, 0x04, 0x8B, 0x07,	// Enable 3 Mappings
	0x04, 0x90, 0x04, 0xAD, 0x15,	// Destionation Controller = Controller 1. Controller 2 sends data to MIPI Port A
	// For the following MSB 2 bits = VC, LSB 6 bits =DT
	0x04, 0x90, 0x04, 0x8D, 0x1E,	/* SRC  0b00011110,DT = 0x1E (YUV422-8bit) VC=0 */
	0x04, 0x90, 0x04, 0x8E, 0x1E,	/* DEST 0b00011110,DT = 0x1E,(YUV422-8bit) 0x1E */
	0x04, 0x90, 0x04, 0x8F, 0x00,	/* SRC  DT = Frame Start */
	0x04, 0x90, 0x04, 0x90, 0x00,	/* DEST DT = Frame Start */
	0x04, 0x90, 0x04, 0x91, 0x01,	/* SRC  DT = Frame End */
	0x04, 0x90, 0x04, 0x92, 0x01,	/* DEST DT = Frame End */

	0x04, 0x90, 0x00, 0x50, 0x00,	/* 9296 pipe X receive stream id 0 from 9295 */
	0x04, 0x90, 0x00, 0x51, 0x02,	/* 9296 pipe Y receive stream id 2 from 9295 */
	0x04, 0x90, 0x00, 0x52, 0x01,	/* 9296 pipe Z receive stream id 1 from 9295 */
	0x04, 0x90, 0x00, 0x53, 0x03,	/* 9296 pipe U receive stream id 3 from 9295 */
};

#endif  // UTILITY_SENSOR_INC_OV2311_OV9284_SETTING_H_


